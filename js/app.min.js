function testWebP(e){var t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}
//! Общие функции================================================
function addActive(...e){for(let t of e)t.classList.add("_active")}function removeActive(...e){for(let t of e)t.classList.remove("_active")}function toggleActive(...e){for(let t of e)t.classList.toggle("_active")}function addPading(e){let t=document.querySelector(".wrapper"),n=document.querySelector("body"),s=window.innerWidth-t.offsetWidth+"px";if(n.style.paddingRight=s,e.length>0)for(let t of e)t.style.paddingRight=s}function removePading(e){if(document.querySelector("body").style.paddingRight="0px",e.length>0)for(let t of e)t.style.paddingRight="0px"}
//!=======================================================================
testWebP((function(e){!0===e?document.querySelector("html").classList.add("_webp"):document.querySelector("html").classList.add("_no-webp")})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".popup-link"),t=document.querySelector("body"),n=document.querySelectorAll(".lock-padding"),s=document.querySelectorAll(".close-popup");let o=!0;const a=800;function l(e,s=!0){o&&(e.classList.remove("popup-open"),s&&(setTimeout((function(){n.length>0&&n.forEach((e=>{e.style.paddingRight="0px"})),t.style.paddingRight="0px",t.classList.remove("lock")}),a),o=!1,setTimeout((function(){o=!0}),a)))}e.length>0&&e.forEach((e=>{e.addEventListener("click",(function(s){const r=e.getAttribute("href").replace("#","");!function(e){if(e&&o){const s=document.querySelector(".popup.popup-open");s?l(s,!1):function(){const e=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px";n.length>0&&n.forEach((t=>{t.style.paddingRight=e}));t.style.paddingRight=e,t.classList.add("lock"),o=!1,setTimeout((function(){o=!0}),a)}(),e.classList.add("popup-open"),e.addEventListener("click",(function(e){e.target.closest(".popup__content")||l(e.target.closest(".popup"))}))}}(document.getElementById(r)),s.preventDefault()}))})),s.length>0&&s.forEach((e=>{e.addEventListener("click",(function(t){l(e.closest(".popup")),t.preventDefault()}))})),document.addEventListener("keydown",(function(e){const t=document.querySelector(".popup.popup-open");27===e.which&&t&&l(t)}))})),Element.prototype.closest||(Element.prototype.closest=function(e){for(var t=this;t;){if(t.matches(e))return t;t=t.parentElement}return null}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll("._point-add");e&&e.forEach(((e,t,n)=>{if(t<n.length-1){let t=document.createElement("li");t.className="_point-add__point",e.after(t)}}));new IntersectionObserver((function(e){e.forEach((e=>{const{target:t,isIntersecting:n}=e;n?t.classList.remove("_scroll"):t.classList.add("_scroll")}))})).observe(document.querySelector(".header"));{const e=document.querySelector(".burger"),t=document.querySelector("body"),n=document.querySelector(".menu__body"),s=document.querySelector(".wrapper"),o=document.querySelectorAll(".add-padding-right");s.addEventListener("click",(function(s){s.target.closest(".popup-link")||(s.target.closest(".burger")&&!e.classList.contains("_active")?(!function(e){let n=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px";if(t.style.paddingRight=n,e.length>0)for(let t of e)t.style.paddingRight=n}(o),addActive(e,n,t)):(s.target.closest(".menu__link")||s.target.closest(".burger")&&e.classList.contains("_active")||s.target.closest("main")||s.target.closest("footer"))&&(removeActive(e,n,t),function(e){if(t.style.paddingRight="0px",e.length>0)for(let t of e)t.style.paddingRight="0px"}(o)))}))}function t(e){let t=e.target;if(t.dataset.goto&&document.querySelector(t.dataset.goto)){let n=t.dataset.goto,s=document.querySelector(n).getBoundingClientRect().top+window.pageYOffset-document.querySelector(".header").offsetHeight;if(e.preventDefault(),document.querySelector(".burger").classList.contains("_active")){let e=document.querySelector(".burger"),t=document.querySelector("body"),n=document.querySelector(".menu__body");e.classList.remove("_active"),t.classList.remove("_active"),n.classList.remove("_active")}window.scrollTo({top:s,behavior:"smooth"}),e.preventDefault()}}null!=document.querySelectorAll("a[data-goto]")&&document.querySelectorAll("a[data-goto]").forEach((e=>{e.addEventListener("click",t)}))})),document.addEventListener("DOMContentLoaded",(()=>{function e(){let e=document.querySelectorAll('[class*="_anim-scroll"]');e.forEach((e=>{const t=.01*function(e,t){let n=t.length,s=e.className.indexOf(t)+n;return e.className.substr(s,2)}(e,"_anim-scroll_"),n=e.offsetHeight,s=e.getBoundingClientRect().top+window.pageYOffset,o=document.documentElement.clientHeight||document.body.clientHeight;let a=o-n*t;n>o&&(a=o-o*t);let l=s-a,r=s+n;window.pageYOffset>l&&window.pageYOffset<r?e.classList.add("_active_anim-scroll"):e.classList.contains("_active_one")||e.classList.remove("_active_anim-scroll")}))}document.querySelectorAll('[class*="_anim-scroll"]').length>0&&(window.addEventListener("scroll",e),setTimeout((()=>{e()}),700))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("[data-tab-tabs]");e&&(e.addEventListener("click",(t=>{if(!t.target.closest("[data-tab-btn]"))return;let n=t.target.closest("[data-tab-btn]"),s=t.target.closest("li");!function(...e){for(let e of arguments)for(let t of e)t.classList.remove("_active")}(e.querySelectorAll("li"),document.querySelectorAll("[data-tab-btn]"),document.querySelectorAll("[data-tab-block]")),function(e,t){let n=e.dataset.tabBtn,s=document.querySelector(`[data-tab-block="${n}"]`);e.classList.add("_active"),s.classList.add("_active"),t.classList.add("_active")}(n,s)})),document.querySelector("._active_first").click())}));let sliders=document.querySelectorAll("._swiper");if(sliders){for(let e=0;e<sliders.length;e++){let t=sliders[e];if(!t.classList.contains("swiper-bild")){let e=t.children;if(e)for(let t=0;t<e.length;t++){e[t].classList.add("swiper-slide")}let n=t.innerHTML,s=document.createElement("div");if(s.classList.add("swiper-wrapper"),s.innerHTML=n,t.innerHTML="",t.appendChild(s),t.classList.add("swiper-bild"),t.classList.contains("_swiper_scroll")){let e=document.createElement("div");e.classList.add("swiper-scrollbar"),t.appendChild(e)}}t.classList.contains("_gallery")}sliders_bild_callback()}function sliders_bild_callback(e){}let sliderScrollItems=document.querySelectorAll("._swiper_scroll");if(sliderScrollItems.length>0)for(let e=0;e<sliderScrollItems.length;e++){const t=sliderScrollItems[e],n=t.querySelector(".swiper-scrollbar");new Swiper(t,{observer:!0,observeParents:!0,direction:"vertical",slidesPerView:"auto",freeMode:!0,scrollbar:{el:n,draggable:!0,snapOnRelease:!1},mousewheel:{releaseOnEdges:!0}}).scrollbar.updateSize()}function sliders_bild_callback(e){}let slider_blog=new Swiper(".blog__body",{observer:!0,observeParents:!0,slidesPerView:1,spaceBetween:0,autoHeight:!1,speed:800,loop:!0,pagination:{el:".blog__bullet",clickable:!0},navigation:{nextEl:".blog__arow_right",prevEl:".blog__arow_left"},on:{lazyImageReady:function(){ibg()}}});const setInputCheek={name:{set:/^[a-zа-я -]{2,16}$/i,help:'Кирилица и латинские буквы, пробелы и знак " - "(тире)'},email:{set:/^[A-Z0-9._%+-]+@[A-Z0-9-]+.+.[A-Z]{2,4}$/i,help:"Указать"},phone:{set:/^((8|\+7)[\- ]?)?(\(?\d{3}\)?[\- ]?)?[\d\- ]{7,10}$/,help:"Российские мобильные и городские с кодом из 3 цифр"},phoneRuMobile:{set:/\+7\(\d+\)\s\d+\s\-\s\d+\s\-\s\d{2}/,help:"Российские мобильные",mask:"+7(___) ___ - __ - __"},class_remove:new Set};
//! ЗАПУСК ====== ЗАПУСК ====== ЗАПУСК ====== ЗАПУСК ====== ЗАПУСК ======
async function sendForm(e){const t=e.target,n=t.getAttribute("action")?t.getAttribute("action").trim():"#",s=t.getAttribute("method")?t.getAttribute("method").trim().toUpperCase():"POST";let o=new FormData(t),a={};if(a.method=s,"POST"==s&&(a.body=o),"#"===n)return alert("Демонстрационный режим отправки формы"),"Демонстрационный режим отправки формы";try{let e=await fetch(n,a);if(200==e.status){return await e.json()}throw new Error(`Ошибка ${e.status} для url: ${n}`)}catch(e){throw console.log(e.message),console.log(e.stack),new Error("Что-то не так")}}function cleanForm(e,...t){let n=e.querySelectorAll(".required");t.length>0?n.forEach((e=>{t.forEach((t=>e.classList.remove(`${t}`)))})):n.forEach((e=>{setInputCheek.class_remove.forEach((t=>e.classList.remove(`${t}`)))}))}function animationSend(e,t){e.hasAttribute("data-animation")&&e.hasAttribute("data-animation-new-titl")&&animationNewTitlSend(e,t)}function animationNewTitlSend(e,t){e.classList.add("pending-animation-end");let n=t||e.getAttribute("data-animation-new-titl"),s=e.querySelector(".titl-main");s.classList.add("owld-titl");let o=document.createElement("div");o.className="new-titl";let a=document.createElement("h1");a.className="new-titl__content titl-main",a.innerHTML=n,o.prepend(a),s.prepend(o),setTimeout((()=>{e.classList.remove("pending-animation-end"),s.classList.remove("owld-titl"),o.remove()}),3e3)}function inputMadeRemoveHelp(e,t=!1){if(t){if(t){e.querySelectorAll(".span-help").forEach((e=>e.classList.add("span-help__remove")))}}else{e.querySelectorAll(".send-error[data-help]").forEach((e=>{let t=e.parentElement;t.style.position="relative";let n=t.querySelector(".span-help");if(n)n.classList.remove("span-help__remove");else{const n=e.getAttribute("name"),s=setInputCheek[n].help;let o=document.createElement("span");o.classList.add("span-help"),o.innerHTML=s,t.append(o)}}))}}function formCheek(e){const t=e.querySelectorAll(".required");let n=t.length;t.forEach((e=>{let t=setInputCheek[e.getAttribute("name")].set,s=e.parentElement;t.test(e.value)?n--:(e.classList.add("send-error"),e.classList.remove("invalid"),s.classList.remove("invalid"))})),inputMadeRemoveHelp(e);const s=e.querySelector(".send-error");return s&&s.focus(),0==n}function spyInput(e,t){return setInputCheek.class_remove.add("send-error"),setInputCheek.class_remove.add("send-ok"),function(){e.classList.contains("send-error")&&t.test(e.value)&&(e.classList.remove("send-error"),e.classList.add("send-ok")),e.classList.contains("send-ok")&&(t.test(e.value)||(e.classList.add("send-error"),e.classList.remove("send-ok")))}}function circulationTabInForm(e){let t=Array.from(e.elements),n=e.elements[0],s=t[t.length-1];t.forEach((t=>{t==n?t.addEventListener("keydown",(n=>{"Escape"==n.code?(t.blur(),cleanForm(e)):"Tab"==n.code&&n.shiftKey&&(n.preventDefault(n),s.focus())})):t==s?t.addEventListener("keydown",(s=>{"Escape"==s.code?(t.blur(),e.reset(),cleanForm(e),cleanMaskShadow(e)):"Tab"!=s.code||s.shiftKey||(s.preventDefault(s),n.focus())})):t.addEventListener("keydown",(n=>{"Escape"==n.code&&(t.blur(),cleanForm(e))}))}))}function cleanMaskShadow(e){let t=e.querySelectorAll("[data-mask-phone-shadow]");t&&t.forEach((e=>{e.style.backgroundColor="";let t=e.parentElement.querySelector(".mask-shadow");madeNewValue({mask:getMaskPhone(e),maskShadow:t},[])}))}function getMaskPhone(e){return removeSpice(e.getAttribute("data-mask-phone")?e.getAttribute("data-mask-phone"):e.name&&setInputCheek?setInputCheek[e.name].mask:"+7(___) ___ ____")}function removeSpice(e){return e.trim().replace(/[^]/g,((e,t,n)=>" "==e&&" "==n.charAt(++t)?"":e))}function maskPhoneFocus(e){let{input:t,mask:n,def:s,maskShadow:o}=e;o&&(t.style.backgroundColor="transparent"),t.value=t.value<s?n.slice(0,s):t.value,setTimeout((()=>{t.selectionStart=t.selectionEnd=t.value.length}),0)}function maskPhoneBlur(e){let{input:t,mask:n,def:s,maskShadow:o}=e;t.classList.contains("required");t.value=t.value.length==n.length?t.value:t.value.length==s?"":t.value,""==t.value&&o&&(t.style.backgroundColor="")}function wrapController(e){let t;return function(n){let{input:s,cursorStart:o,cursorEnd:a,mask:l}=n,r=s.selectionStart;s.value.length>l.length&&r-a==1?(s.value=t,s.selectionStart=s.selectionEnd=o):t=e(n)}}function maskPhoneInput(e){let{input:t,cursorStart:n}=e,s=t.value.slice(n,t.selectionStart).replace(/\D/g,""),o=madeNewValue(e,getValueInput(e,s)),a=setCursor(e,s);return t.value=o,null!=a&&(t.selectionStart=t.selectionEnd=a),o}function getValueInput(e,t){let{input:n,cursorStart:s,cursorEnd:o,def:a}=e,l=n.selectionStart,r=0==t.length&&s==o?setShift(e,l):0,i=s<l?s:l;return(n.value.slice(0,s>l?l-r:s)+t+n.value.slice(o<a?l+(a-o):l+(l<o&&0!=r?0:r))).slice(i<a?i:a).match(/\d/g)||[]}function setCursor(e,t){let n,{input:s,mask:o,cursorStart:a,cursorEnd:l,def:r}=e,i=s.selectionStart;if(t.length>0){let e,s=0;o.replace(/[^]/g,((n,o)=>{o>=(a<i?a:i)&&"_"==n&&s++<t.length&&(e=++o)})),n=e}else 0==t.length&&(n=l-i==1?i<r?r:o.lastIndexOf("_",i):o.indexOf("_",l));return n}function setShift(e,t){let{mask:n,cursorEnd:s}=e,o=n.indexOf("_");if(t<s){let e=n.lastIndexOf("_",t);return-1==e?0:t-e}if(t>=s){let e=n.indexOf("_",s);return e<=o?0:e-s}}function madeNewValue(e,t){let{mask:n,maskShadow:s}=e,o=0,a=n.replace(/[_]/g,(e=>o<t.length?t[o++]:e)),l=a.indexOf("_"),r=-1==l?a:a.slice(0,l);return s&&madeShadowInput(e,r),r}function madeShadowInput(e,t){let{mask:n,maskShadow:s}=e,o=s.querySelectorAll("span"),a=0;o.forEach((e=>{a<t.length?(e.innerHTML=t.charAt(a++),e.classList.add("mask-shadow__span_hiden")):(e.innerHTML=n.charAt(a++),e.classList.remove("mask-shadow__span_hiden"))}))}function makeShadow(e){let{input:t,mask:n,def:s}=e,o=t.parentElement;o.style.position="relative",o.style.zIndex="1";let a=t.className.replace("required",""),l=document.createElement("div");l.classList=a,l.classList.add("mask-shadow"),l.style.position="absolute",l.style.top="0",l.style.left="0",l.style.width="100%",l.style.height="100%",l.style.display="flex",l.style.alignItems="center",l.style.pointerEvents="none",l.style.lineHeight="normal",l.style.zIndex="-1";let r=document.createElement("div");return r.classList.add("mask-shadow__body"),r.innerHTML=n.replace(/[^]/g,((e,t)=>t<s?`<span class ="mask-shadow__span mask-shadow__span_hiden">${e}</span>`:`<span class ="mask-shadow__span">${e}</span>`)),l.prepend(r),t.after(l),l}document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll("form").forEach((e=>{const t=e.querySelectorAll(".required");circulationTabInForm(e),
//! ДЛЯ ФОРМ БЕЗ ПРОВЕРКИ
t&&t&&setInputCheek&&t.forEach((e=>{let n=e.parentElement,s=e.getAttribute("placeholder");e.setAttribute("placeholder",`${s} *`);const o=setInputCheek[e.getAttribute("name")].set;let a=spyInput(e,o);e.addEventListener("blur",(()=>{setInputCheek.class_remove.add("invalid"),e.classList.contains("send-error")||o.test(e.value)||(e.classList.add("invalid"),n.classList.add("invalid"))})),e.addEventListener("focus",(()=>{setInputCheek.class_remove.add("invalid"),e.classList.contains("invalid")&&(e.classList.remove("invalid"),n.classList.remove("invalid")),e.addEventListener("input",a)})),e.addEventListener("keydown",(e=>{"Escape"==e.code&&t.forEach((e=>{e.removeEventListener("input",a)}))}))})),
//! ДЛЯ ВСЕХ ФОРМ устанавливаем слушателя на отправку через проверку класса onsubmit-has 
//! чтобы избежать множественных слушателей и отправок
e.classList.contains("onsubmit-has")||(e.classList.add("onsubmit-has"),e.addEventListener("submit",(n=>{n.preventDefault(),e.classList.contains("pending-animation-end")||t&&!formCheek(e)||sendForm(n).then((t=>{console.log(t),e.focus(),animationSend(e),inputMadeRemoveHelp(e,!0),cleanForm(e),e.reset(),cleanMaskShadow(e)})).catch((t=>{animationSend(e,t.message)}))})))}))})),document.addEventListener("DOMContentLoaded",(()=>{maskPhoneInput=wrapController(maskPhoneInput),document.querySelectorAll("[data-mask-phone]").forEach((e=>{let t=e.getAttribute("placeholder")?e.getAttribute("placeholder"):e.getAttribute("data-mask-phone")?e.getAttribute("data-mask-phone"):e.name&&setInputCheek?setInputCheek[e.name].mask:"";e.placeholder=removeSpice(t);let n,s,o=getMaskPhone(e),a=o.slice(0,o.indexOf("_")).length,l=!!e.hasAttribute("data-mask-phone-shadow")&&makeShadow({input:e,mask:o,def:a});e.addEventListener("keydown",(()=>{n=e.selectionStart,s=e.selectionEnd})),e.addEventListener("contextmenu",(()=>{n=e.selectionStart,s=e.selectionEnd})),e.addEventListener("input",(()=>maskPhoneInput({input:e,mask:o,cursorStart:n,cursorEnd:s,def:a,maskShadow:l}))),e.addEventListener("focus",(()=>maskPhoneFocus({input:e,mask:o,cursorStart:n,cursorEnd:s,def:a,maskShadow:l}))),e.addEventListener("blur",(()=>maskPhoneBlur({input:e,mask:o,cursorStart:n,cursorEnd:s,def:a,maskShadow:l})))}))}));